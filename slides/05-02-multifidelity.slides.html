<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="dcterms.date" content="2020-11-06">
  <title>Multifidelity Modelling</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="reveal.js/css/reveal.css">
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" href="reveal.js/css/theme/black.css" id="theme">
  <link rel="stylesheet" href="../assets/css/talks.css"/>
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="reveal.js/lib/js/html5shiv.js"></script>
  <![endif]-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG" type="text/javascript"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    TeX: {
         extensions: ["color.js"]
      }
    });
  </script>
  <script src="../assets/js/figure-animate.js"></script>
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Multifidelity Modelling</h1>
  <p class="author" style="text-align:center"><a href="http://inverseprobability.com">Neil D. Lawrence</a></p>
  <p class="date" style="text-align:center"><time>2020-11-06</time></p>
  <p class="venue" style="text-align:center">Virtual (Zoom)</p>
</section>

<section class="slide level2">

<!-- Do not edit this file locally. -->
<!---->
<!-- Do not edit this file locally. -->
<!-- The last names to be defined. Should be defined entirely in terms of macros from above-->
<!--

-->
<!--setupplotcode{import seaborn as sns
sns.set_style('darkgrid')
sns.set_context('paper')
sns.set_palette('colorblind')}-->
<!-- SECTION An Introduction to Multi-fidelity Modeling in Emukit -->
</section>
<section id="an-introduction-to-multi-fidelity-modeling-in-emukit" class="slide level2">
<h2>An Introduction to Multi-fidelity Modeling in Emukit</h2>
<div class="figure">
<div id="statistical-emulation-6-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/uq/statistical-emulation004.svg" width="80%" style=" ">
</object>
</div>
</div>
<aside class="notes">
A statistical emulator is a system that reconstructs the simulation with a statistical model. As well as reconstructing the simulation, a statistical emulator can be used to correlate with the real world.
</aside>
</section>
<section id="overview" class="slide level2">
<h2>Overview</h2>
</section>
<section id="linear-multi-fidelity-model" class="slide level2">
<h2>Linear multi-fidelity model</h2>
<p><span class="math display">\[
f_{\text{high}}(x) = f_{\text{err}}(x) + \rho \,f_{\text{low}}(x)
\]</span></p>
<p><span class="math display">\[
f_{t}(x) = f_{t}(x) + \rho_{t-1} \,f_{t-1}(x), \quad t=1,\dots, T
\]</span></p>
<p><span class="math display">\[
\begin{pmatrix}
\mathbf{X}_{\text{low}} \\
\mathbf{X}_{\text{high}}
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[
\begin{bmatrix}
f_{\text{low}}\left(h\right)\\
f_{\text{high}}\left(h\right)
\end{bmatrix}
\sim
GP
\begin{pmatrix}
\begin{bmatrix}
0 \\ 0
\end{bmatrix},
\begin{bmatrix}
k_{\text{low}} &amp; \rho k_{\text{low}} \\
\rho k_{\text{low}} &amp; \rho^2 k_{\text{low}} + k_{\text{err}}
\end{bmatrix}
\end{pmatrix}
\]</span></p>
</section>
<section id="linear-multi-fidelity-modeling-in-emukit" class="slide level2">
<h2>Linear multi-fidelity modeling in Emukit</h2>
<p><span class="math display">\[
\mathbf{X}= \begin{pmatrix}
x_{\text{low};0}^0 &amp; x_{\text{low};0}^1 &amp; x_{\text{low};0}^2 &amp; 0\\
x_{\text{low};1}^0 &amp; x_{\text{low};1}^1 &amp; x_{\text{low};1}^2 &amp; 0\\
x_{\text{low};2}^0 &amp; x_{\text{low};2}^1 &amp; x_{\text{low};2}^2 &amp; 0\\
x_{\text{high};0}^0 &amp; x_{\text{high};0}^1 &amp; x_{\text{high};0}^2 &amp; 1\\
x_{\text{high};1}^0 &amp; x_{\text{high};1}^1 &amp; x_{\text{high};1}^2 &amp; 1
\end{pmatrix}\quad
\mathbf{Y}= \begin{pmatrix}
y_{\text{low};0}\\
y_{\text{low};1}\\
y_{\text{low};2}\\
y_{\text{high};0}\\
y_{\text{high};1}
\end{pmatrix}
\]</span></p>
<div class="figure">
<div id="high-and-low-fidelity-forrester-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/uq/high-and-low-fidelity-forrester.svg" width="80%" style=" ">
</object>
</div>
</div>
<aside class="notes">
High and low fidelity Forrester functions.
</aside>
<div class="figure">
<div id="linear-multi-fidelity-model-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/uq/linear-multi-fidelity-model.svg" width="80%" style=" ">
</object>
</div>
</div>
<aside class="notes">
Linear multi-fidelity model fit to low and high fidelity Forrester function
</aside>
</section>
<section id="comparison-to-standard-gp" class="slide level2">
<h2>Comparison to standard GP</h2>
<div class="figure">
<div id="linear-multi-fidelity-high-fidelity-gp-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/uq/linear-multi-fidelity-high-fidelity-gp.svg" width="80%" style=" ">
</object>
</div>
</div>
<aside class="notes">
Comparison of linear multi-fidelity model and high fidelity GP
</aside>
</section>
<section id="nonlinear-multi-fidelity-model" class="slide level2">
<h2>Nonlinear multi-fidelity model</h2>
<p><span class="math display">\[
f_{\text{low}}(x) = \sin(8\pi x)
\]</span></p>
<p><span class="math display">\[
f_{\text{high}}(x) = \left(x- \sqrt{2}\right) \, f_{\text{low}}^2
\]</span></p>
<div class="figure">
<div id="high-and-low-fidelity-functions-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/uq/high-and-low-fidelity-functions.svg" width="80%" style=" ">
</object>
</div>
</div>
<aside class="notes">
High and low fidelity functions
</aside>
<div class="figure">
<div id="mapping-low-to-high-fidelity-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/uq/mapping-low-to-high-fidelity.svg" width="80" style=" ">
</object>
</div>
</div>
<aside class="notes">
Mapping from low fidelity to high fidelity.
</aside>
</section>
<section id="failure-of-linear-multi-fidelity-model" class="slide level2">
<h2>Failure of linear multi-fidelity model</h2>
<div class="figure">
<div id="linear-multi-fidelity-model-fit-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/uq/linear-multi-fidelity-model-fit.svg" width="80%" style=" ">
</object>
</div>
</div>
<aside class="notes">
Linear multi-fidelity model fit to high fidelity function
</aside>
</section>
<section id="nonlinear-multi-fidelity-model-1" class="slide level2">
<h2>Nonlinear Multi-fidelity model</h2>
<p><span class="math display">\[ 
f_{\text{high}}(x) = \rho( \, f_{\text{low}}(x)) + \delta(x) 
\]</span></p>
<div class="figure">
<div id="-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/uq/nonlinear-multi-fidelity-model-fit.svg" width="80%" style=" ">
</object>
</div>
</div>
<aside class="notes">
Nonlinear multi-fidelity model fit to low and high fidelity functions.
</aside>
<div class="figure">
<div id="mapping-low-fidelity-to-high-fidelity-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/uq/mapping-low-fidelity-to-high-fidelity.svg" width="80%" style=" ">
</object>
</div>
</div>
<aside class="notes">
Mapping from low fidelity to high fidelity
</aside>
</section>
<section id="mountain-car-simulator" class="slide level2">
<h2>Mountain Car Simulator</h2>
<div class="figure">
<div id="mountain-car-figure" class="figure-frame">
<div class="centered" style="">
<img class="negate" src="../slides/diagrams/uq/mountaincar.png" width="60%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
</div>
<aside class="notes">
The mountain car simulation from the Open AI gym.
</aside>
</section>
<section id="car-dynamics" class="slide level2">
<h2>Car Dynamics</h2>
<p><span class="math display">\[
\mathbf{ x}_{t+1} = f(\mathbf{ x}_{t},\textbf{u}_{t})
\]</span> where <span class="math inline">\(\textbf{u}_t\)</span> is the action force, <span class="math inline">\(\mathbf{ x}_t = (p_t, v_t)\)</span> is the vehicle state</p>
</section>
<section id="policy" class="slide level2">
<h2>Policy</h2>
<ul>
<li>Assume policy is linear with parameters <span class="math inline">\(\boldsymbol{\theta}\)</span> <span class="math display">\[
\pi(\mathbf{ x},\theta)= \theta_0 + \theta_p p + \theta_vv.
\]</span></li>
</ul>
</section>
<section id="emulate-the-mountain-car" class="slide level2">
<h2>Emulate the Mountain Car</h2>
<ul>
<li>Goal is find <span class="math inline">\(\theta\)</span> such that <span class="math display">\[
\theta^* = arg \max_{\theta} R_T(\theta).
\]</span></li>
<li>Reward is computed as 100 for target, minus squared sum of actions</li>
</ul>
</section>
<section id="random-linear-controller" class="slide level2">
<h2>Random Linear Controller</h2>
<div class="figure">
<div id="mountain-car-random-figure" class="figure-frame">
<iframe src="../slides/diagrams/uq/mountain_car_random.html" width="600" height="450" allowtransparency="true" frameborder="0">
</iframe>
</div>
</div>
<aside class="notes">
Random linear controller for the Mountain car. It fails to move the car to the top of the mountain.
</aside>
</section>
<section id="best-controller-after-50-iterations-of-bayesian-optimization" class="slide level2">
<h2>Best Controller after 50 Iterations of Bayesian Optimization</h2>
<div class="figure">
<div id="mountain-car-similated-bayes-opt-figure" class="figure-frame">
<iframe src="../slides/diagrams/uq/mountain_car_simulated.html" width="600px" height="450px" allowtransparency="true" frameborder="0">
</iframe>
</div>
</div>
<aside class="notes">
Mountain car simulator trained using Bayesian optimization and the simulator of the dynamics. Fifty iterations of Bayesian optimization are used to optimize the controler.
</aside>
</section>
<section id="data-efficient-emulation" class="slide level2">
<h2>Data Efficient Emulation</h2>
<ul>
<li><p>For standard Bayesian Optimization ignored <em>dynamics</em> of the car.</p></li>
<li><p>For more data efficiency, first <em>emulate</em> the dynamics.</p></li>
<li><p>Then do Bayesian optimization of the <em>emulator</em>.</p></li>
<li><p>Use a Gaussian process to model <span class="math display">\[\Delta v_{t+1} = v_{t+1} - v_{t}\]</span> and <span class="math display">\[\Delta x_{t+1} = p_{t+1} - p_{t}\]</span></p></li>
<li><p>Two processes, one with mean <span class="math inline">\(v_{t}\)</span> one with mean <span class="math inline">\(p_{t}\)</span></p></li>
</ul>
</section>
<section id="emulator-training" class="slide level2">
<h2>Emulator Training</h2>
<ul>
<li><p>Used 500 randomly selected points to train emulators.</p></li>
<li><p>Can make proces smore efficient through <em>experimental design</em>.</p></li>
</ul>
</section>
<section id="comparison-of-emulation-and-simulation" class="slide level2">
<h2>Comparison of Emulation and Simulation</h2>
<div class="figure">
<div id="emu-sim-comparison-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/uq/emu_sim_comparison.svg" width="80%" style=" ">
</object>
</div>
</div>
<aside class="notes">
Comparison between the mountain car simulator and the emulator.
</aside>
</section>
<section id="data-efficiency" class="slide level2">
<h2>Data Efficiency</h2>
<ul>
<li><p>Our emulator used only 500 calls to the simulator.</p></li>
<li><p>Optimizing the simulator directly required 37,500 calls to the simulator.</p></li>
</ul>
</section>
<section id="best-controller-using-emulator-of-dynamics" class="slide level2">
<h2>Best Controller using Emulator of Dynamics</h2>
<div class="figure">
<div id="mountain-car-emulated-figure" class="figure-frame">
<iframe src="../slides/diagrams/uq/mountain_car_emulated.html" width="800px" height="600px" allowtransparency="true" frameborder="0">
</iframe>
</div>
</div>
<aside class="notes">
Mountain car controller learnt through emulation. Here 500 calls to the simulator are used to fit the controller rather than 37,500 calls to the simulator required in the standard learning.
</aside>
<p>500 calls to the simulator vs 37,500 calls to the simulator</p>
</section>
<section id="multi-fidelity-emulation" class="slide level2">
<h2>Multi-Fidelity Emulation</h2>
<p><span class="math display">\[f_i\left(\mathbf{ x}\right) = \rho f_{i-1}\left(\mathbf{ x}\right) + \delta_i\left(\mathbf{ x}\right)\]</span></p>
<p><span class="math display">\[f_i\left(\mathbf{ x}\right) = g_{i}\left(f_{i-1}\left(\mathbf{ x}\right)\right) + \delta_i\left(\mathbf{ x}\right),\]</span></p>
</section>
<section id="best-controller-with-multi-fidelity-emulator" class="slide level2">
<h2>Best Controller with Multi-Fidelity Emulator</h2>
<div class="figure">
<div id="mountain-car-multi-fidelity-figure" class="figure-frame">
<iframe src="../slides/diagrams/uq/mountain_car_multi_fidelity.html" width="800px" height="600px" allowtransparency="true" frameborder="0">
</iframe>
</div>
</div>
<aside class="notes">
Mountain car learnt with multi-fidelity model. Here 250 observations of the high fidelity simulator and 250 observations of the low fidelity simulator are used to learn the controller.
</aside>
<p>250 observations of high fidelity simulator and 250 of the low fidelity simulator</p>
</section>
<section id="thanks" class="slide level2 scrollable">
<h2 class="scrollable">Thanks!</h2>
<ul>
<li>twitter: <a href="https://twitter.com/lawrennd">@lawrennd</a></li>
<li>podcast: <a href="http://thetalkingmachines.com">The Talking Machines</a></li>
<li>newspaper: <a href="http://www.theguardian.com/profile/neil-lawrence">Guardian Profile Page</a></li>
<li>blog: <a href="http://inverseprobability.com/blog.html">http://inverseprobability.com</a></li>
</ul>
</section>
<section id="references" class="slide level2 scrollable">
<h2 class="scrollable">References</h2>
</section>
    </div>
  </div>

  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Push each slide change to the browser history
        history: true,
        // Transition style
        transition: 'None', // none/fade/slide/convex/concave/zoom
        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // Optional reveal.js plugins
        dependencies: [
          { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
          { src: 'reveal.js/plugin/math/math.js', async: true },
          { src: 'reveal.js/plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
