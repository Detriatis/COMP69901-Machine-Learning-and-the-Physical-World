---
title: "Emulation"
abstract: "<p>In this lecture we motivate the use of emulation and
introduce the GPy software as a framework for building Gaussian process
emulators.</p>"
author:
- given: Neil D.
  family: Lawrence
  url: http://inverseprobability.com
  institute: University of Cambridge
  twitter: lawrennd
  gscholar: r3SJcvoAAAAJ
  orcid: 
edit_url: https://github.com/mlatcl/mlphysical/edit/gh-pages/_lamd/emulation.md
date: 2024-10-29
published: 2024-10-29
time: "12:00"
week: 3
session: 2
featured_image: slides/diagrams/uq/emukit-playground-bayes-opt.png
reveal: 03-02-emulation.slides.html
transition: None
ipynb: 03-02-emulation.ipynb
youtube: "-dOrt-hi-uI"
layout: lecture
categories:
- notes
---



<!-- Do not edit this file locally. -->
<!---->
<!-- Do not edit this file locally. -->
<!-- Do not edit this file locally. -->
<!-- The last names to be defined. Should be defined entirely in terms of macros from above-->
<!--

-->
<!--setupplotcode{import seaborn as sns
sns.set_style('darkgrid')
sns.set_context('paper')
sns.set_palette('colorblind')}-->
<h2 id="notutils">notutils</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_software/includes/notutils-software.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_software/includes/notutils-software.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>This small package is a helper package for various notebook utilities
used below.</p>
<p>The software can be installed using</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>pip install notutils</span></code></pre></div>
<p>from the command prompt where you can access your python
installation.</p>
<p>The code is also available on GitHub: <a
href="https://github.com/lawrennd/notutils"
class="uri">https://github.com/lawrennd/notutils</a></p>
<p>Once <code>notutils</code> is installed, it can be imported in the
usual manner.</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> notutils</span></code></pre></div>
<h2 id="mlai">mlai</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_software/includes/mlai-software.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_software/includes/mlai-software.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>The <code>mlai</code> software is a suite of helper functions for
teaching and demonstrating machine learning algorithms. It was first
used in the Machine Learning and Adaptive Intelligence course in
Sheffield in 2013.</p>
<p>The software can be installed using</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>pip install mlai</span></code></pre></div>
<p>from the command prompt where you can access your python
installation.</p>
<p>The code is also available on GitHub: <a
href="https://github.com/lawrennd/mlai"
class="uri">https://github.com/lawrennd/mlai</a></p>
<p>Once <code>mlai</code> is installed, it can be imported in the usual
manner.</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mlai</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mlai <span class="im">import</span> plot</span></code></pre></div>
<h2 id="accelerate-programme">Accelerate Programme</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_ml/includes/accelerate-programme.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_ml/includes/accelerate-programme.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>The Computer Lab is hosting a new initiative, funded by Schmidt
Futures, known as the <a
href="https://acceleratescience.github.io/">Accelerate Programme for
Scientific Discovery</a>. The aim is to address scientific challenges,
and accelerate the progress of research, through using tools in machine
learning.</p>
<p>We now have four fellows appointed, each of whom works at the
interface of machine learning and scientific discovery. They are using
the ideas around machine learning modelling to drive their scientific
research.</p>
<p>For example, <a
href="https://acceleratescience.github.io/team/bingqing-cheng.html">Bingqing
Cheng</a>, one of the Department’s former DECAF Fellows has used neural
network accelerated molecular dynamics simulations to understand a new
form of metallic hydrogen, likely to occur at the heart of stars <span
class="citation" data-cites="Cheng-evidence20">(Cheng et al.,
2020)</span>. The University’s <a
href="https://www.cam.ac.uk/research/news/ai-shows-how-hydrogen-becomes-a-metal-inside-giant-planets">press
release is here</a>.</p>
<h1 id="related-approaches">Related Approaches</h1>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_ml/includes/related-approaches.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_ml/includes/related-approaches.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>While this module is mainly focusing on emulation as a route to
bringing machine learning closer to the physical world, I don’t want to
give the impression that’s the only approach. It’s worth bearing in mind
three important domains of machine learning (and statistics) that we
also could have explored.</p>
<ul>
<li>Probabilistic Programming</li>
<li>Approximate Bayesian Computation</li>
<li>Causal inference</li>
</ul>
<p>Each of these domains also brings a lot to the table in terms of
understanding the physical world.</p>
<h2 id="probabilistic-programming">Probabilistic Programming</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_ml/includes/probabilistic-programming.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_ml/includes/probabilistic-programming.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>Probabilistic programming is an idea that, from our perspective, can
be summarized as follows. What if, when constructing your simulator, or
your model, you used a programming language that was aware of the state
variables and the probability distributions. What if this language could
‘compile’ the program into code that would automatically compute the
Bayesian posterior for you?</p>
<p>This is the objective of probabilistic programming. The idea is that
you write your model in a language, and that language is automatically
converted into the different modelling codes you need to perform
Bayesian inference.</p>
<p>The ideas for probabilistic programming originate in <a
href="https://www.mrc-bsu.cam.ac.uk/software/bugs/">BUGS</a>. The
software was developed at the MRC Biostatistics Unit here in Cambridge
in the early 1990s, by among others, <a
href="https://en.wikipedia.org/wiki/David_Spiegelhalter">Sir David
Spiegelhalter</a>. Carl Henrik covered in last week’s lecture some of
the approaches for approximate inference. BUGS uses Gibbs sampling.
Gibbs sampling, however, can be slow to converge when there are strong
correlations in the posterior between variables.</p>
<h2 id="approximate-bayesian-computation">Approximate Bayesian
Computation</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_ml/includes/approximate-bayesian-computation.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_ml/includes/approximate-bayesian-computation.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>We reintroduced Gaussian processes at the start of this lecture by
sampling from the Gaussian process and matching the samples to data,
discarding those that were distant from our observations. This approach
to Bayesian inference is the starting point for <em>approximate Bayesian
computation</em> or ABC.</p>
<p>The idea is straightforward, if we can measure ‘closeness’ in some
relevant fashion, then we can sample from our simulation, compare our
samples to real world data through ‘closeness measure’ and eliminate
samples that are distant from our data. Through appropriate choice of
closeness measure, our samples can be viewed as coming from an
approximate posterior.</p>
<p>My Sheffield colleague, Rich Wilkinson, was one of the pioneers of
this approach during his PhD in the Statslab here in Cambridge. You can
hear Rich talking about ABC at NeurIPS in 2013 here.</p>
<div class="figure">
<div id="rich-wilkinson-abc-figure" class="figure-frame">
<iframe width="600" height="450" src="https://www.youtube.com/embed/sssbLkn2JjI?start=" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
</div>
<div id="rich-wilkinson-abc-magnify" class="magnify"
onclick="magnifyFigure(&#39;rich-wilkinson-abc&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="rich-wilkinson-abc-caption" class="caption-frame">
<p>Figure: Rich Wilkinson giving a Tutorial on ABC at NeurIPS in 2013.
Unfortunately, they’ve not synchronised the slides with the tutorial.
You can find the slides <a
href="http://media.nips.cc/Conferences/2013/Video/Tutorial2B.pdf">separately
here</a>.</p>
</div>
</div>
<h2 id="causality">Causality</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_ml/includes/causality-section.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_ml/includes/causality-section.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<div class="figure">
<div id="judea-pearl-causality-figure" class="figure-frame">
<iframe width="600" height="450" src="https://www.youtube.com/embed/yksduYxEusQ?start=" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
</div>
<div id="judea-pearl-causality-magnify" class="magnify"
onclick="magnifyFigure(&#39;judea-pearl-causality&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="judea-pearl-causality-caption" class="caption-frame">
<p>Figure: Judea Pearl and Elias Bareinboim giving a Tutorial on
Causality at NeurIPS in 2013. Again, the slides aren’t synchronised, but
you can find them separately <a
href="http://media.nips.cc/Conferences/2013/nips-dec2013-pearl-bareinboim-tutorial-full.pdf">here</a>.</p>
</div>
</div>
<p>All these approaches offer a lot of promise for developing machine
learning at the interface with science but covering each in detail would
require four separate modules. We’ve chosen to focus on the emulation
approach, for two principal reasons. Firstly, it’s conceptual
simplicity. Our aim is to replace all or part of our simulation with a
machine learning model. Typically, we’re going to want uncertainties as
part of that representation. That explains our focus on Gaussian process
models. Secondly, the emulator method is flexible. Probabilistic
programming requires that the simulator has been built in a particular
way, otherwise we can’t compile the program. Finally, the emulation
approach can be combined with any of the existing simulation approaches.
For example, we might want to write our emulators as probabilistic
programs. Or we might do causal analysis on our emulators, or we could
speed up the simulation in ABC through emulation.</p>
<p>We’ve introduced the notion of a simulator. A body of computer code
that expresses our understanding of a particular physical system. We
introduced such simulators through <em>physical laws</em>, such as laws
of gravitation or electro-magnetism. But we soon saw that in many
simulations those laws become abstracted, and the simulation becomes
more phenomological.</p>
<p>Even full knowledge of all laws does not give us access to ‘the mind
of God’, because we are lacking information about the data, and we are
missing the compute. These challenges further motivate the need for
abstraction, and we’ve seen examples of where such abstractions are used
in practice.</p>
<p>The example of Conway’s Game of Life highlights how complex emergent
phenomena can require significant computation to explore.</p>
<h1 id="emulation">Emulation</h1>
<p>There are a number of ways we can use machine learning to accelerate
scientific discovery. But one way is to have the machine learning model
learn the effect of the rules. Rather than worrying about the detail of
the rules through computing each step, we can have the machine learning
model look to abstract the rules and capture emergent phenomena, just as
the Maxwell-Boltzmann distribution captures the essence of the behavior
of the ideal gas.</p>
<p>The challenges of Laplace’s gremlin present us with issues that we
solve in a particular way, this is the focus of Chapter 6 in <em>The
Atomic Human</em>.</p>
<h1 id="the-atomic-human">The Atomic Human</h1>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_books/includes/the-atomic-human.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_books/includes/the-atomic-human.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<div class="figure">
<div id="the-atomic-human-figure" class="figure-frame">
<div class="centered" style="">
<img class="" src="https://mlatcl.github.io/mlphysical/./slides/diagrams//books/the-atomic-human.jpg" width="40%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
<div id="the-atomic-human-magnify" class="magnify"
onclick="magnifyFigure(&#39;the-atomic-human&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="the-atomic-human-caption" class="caption-frame">
<p>Figure: <a href="https://www.amazon.co.uk/dp/B0CGZHBSLL">The Atomic
Human</a> <span class="citation"
data-cites="Lawrence-atomic24">(Lawrence, 2024)</span>.</p>
</div>
</div>
<p>What follows is a quote form Chapter 6, which introduces Laplace’s
gremlin and its consequences.</p>
<h2 id="deep-thought-and-the-challenge-of-computation">Deep Thought and
the Challenge of Computation</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_simulation/includes/deep-thought-simulation.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_simulation/includes/deep-thought-simulation.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>In Douglas Adams’s <em>Hitchhiker’s Guide to the Galaxy</em> the
computer Deep Thought is asked to provide the answer to the ‘great
question’ of ‘life, the universe and everything’. After seven and a half
million years of computation, Deep Thought has completed its program but
is reluctant to give its creators the answer.</p>
<blockquote>
<p>‘You’re really not going to like it,’ observed Deep Thought.<br />
‘Tell us!’<br />
‘All right,’ said Deep Thought. ‘The Answer to the Great Question . .
.’<br />
‘Yes . . . !’<br />
‘Of Life, the Universe and Everything …’ said Deep Thought.<br />
‘Yes … !’<br />
‘Is …’ said Deep Thought, and paused.<br />
‘Yes … !’<br />
‘Is …’<br />
‘Yes … !!! … ?’<br />
‘Forty-two,’ said Deep Thought, with infinite majesty and calm.</p>
<p>Douglas Adams <em>The Hitchhiker’s Guide to the Galaxy</em>, 1979,
Chapter 27</p>
</blockquote>
<p>After a period of shock from the questioners, the machine goes on to
explain:</p>
<blockquote>
<p>‘I checked it very thoroughly,’ said the computer, ‘and that quite
definitely is the answer. I think the problem, to be quite honest with
you, is that you’ve never actually known what the question is.’</p>
<p>Douglas Adams <em>The Hitchhiker’s Guide to the Galaxy</em>, 1979,
Chapter 28</p>
</blockquote>
<p>To understand the question, Deep Thought goes on to agree to design a
computer which will work out what the question is. In the book that
machine is the planet Earth, and its operators are mice. Deep Thought’s
idea is that the mice will observe the Earth and their observations will
allow them to know what the Great Question is.</p>
<p>To understand the consequences of Hawking’s Theory of Everything, we
would have to carry out a scheme similar to Deep Thought’s. The Theory
wouldn’t directly tell us that hurricanes exist or that when the sun
sets on Earth the sky will have a red hue. It wouldn’t directly tell us
that water will boil at 100 degrees centigrade. These consequences of
the Theory would only play out once it was combined with the data to
give us the emergent qualities of the Universe. The Deep Thought problem
hints at the intractability of doing this. The computation required to
make predictions from Laplace’s demon can be enormous, Deep Thought
intends to create a planet to run it. As a result, this isn’t how our
intelligence works in practice. The computations required are just too
gargantuan. Relative to the scale of the Universe our brains are
extremely limited. Fortunately though, to make these predictions, we
don’t have to build our own Universe, because we’ve already got one.</p>
<div class="figure">
<div id="pooh-rabbit-hoosh-figure" class="figure-frame">
<div class="centered" style="">
<img class="" src="https://mlatcl.github.io/mlphysical/./slides/diagrams//ml/E.-H.-Shepard_Two-ink-drawings-from-The-House-at-Pooh-Corner-I_.jpg" width="80%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
<div id="pooh-rabbit-hoosh-magnify" class="magnify"
onclick="magnifyFigure(&#39;pooh-rabbit-hoosh&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="pooh-rabbit-hoosh-caption" class="caption-frame">
<p>Figure: Rabbit and Pooh watch the result of Pooh’s hooshing idea to
move Eeyore towards the shore.</p>
</div>
</div>
<blockquote>
<p>When you are a Bear of Very Little Brain, and you Think of Things,
you find sometimes that a Thing which seemed very Thingish inside you is
quite different when it gets out into the open and has other people
looking at it.</p>
<p>A.A. Milne as Winnie-the-Pooh in <em>The House at Pooh Corner</em>,
1928</p>
</blockquote>
<p>This comment from Pooh bear comes just as he’s tried to rescue his
donkey friend, Eeyore, from a river by dropping a large stone on him
from a bridge. Pooh’s idea had been to create a wave to push the donkey
to the shore, a process that Pooh’s rabbit friend calls “hooshing”.</p>
<p>Hooshing is a technique many children will have tried to retrieve a
ball from a river. It can work, so Pooh’s idea wasn’t a bad one, but the
challenge he faced was in its execution. Pooh aimed to the side of
Eeyore, unfortunately the stone fell directly on the stuffed donkey. But
where is Laplace’s demon in hooshing? Just as we can talk about Gliders
and Loafers in Conway’s Game of Life, we talk about stones and donkeys
in our Universe. Pooh’s prediction that he can hoosh the donkey with the
stone is not based on the Theory, it comes from observing the way
objects interact in the actual Universe. Pooh is like the mice in
Douglas Adams’s Earth. He is observing his environment. He looks for
patterns in that environment. Pooh then borrows the computation that the
Universe has already done for us. He has seen similar situations before,
perhaps he once used a stone to hoosh a ball. He is then generalising
from these previous circumstances to suggest that he can also hoosh the
donkey. Despite being a bear of little brain, like the mice on Adams’s
Earth, Pooh can answer questions about his universe by observing the
results of the Theory of Everything playing out around him.</p>
<h1 id="surrogate-modelling-in-practice">Surrogate Modelling in
Practice</h1>
<p>The knowledge of ones own limitations that Pooh shows is sometimes
known as Socratic wisdom, and its a vital part of our intelligence. It
expresses itself as humility and skepticism.</p>
<p>In the papers we reviewed last lecture, neural networks are being
used to speed up computations. In this course we’ve introduced Gaussian
processes that will be used to speed up these computations. In both
cases the ideas are similar. Rather than rerunning the simulation, we
use data from the simulation to <em>fit</em> the neural network or the
Gaussian process to the data.</p>
<p>We’ll see an example of how this is done in a moment, taken from a
simple ride hailing simulator, but before we look at that, we’ll first
consider why this might be a useful approach.</p>
<p>As we’ve seen from the very simple rules in the Game of Life,
emergent phenomena we might be interested in take computation power to
discover, just as Laplace’s and Dirac’s quotes suggest. The objective in
surrogate modelling is to harness machine learning models to learn those
physical characteristics.</p>
<h2 id="types-of-simulations">Types of Simulations</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_simulation/includes/simulation-types.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_simulation/includes/simulation-types.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<h3 id="differential-equation-models">Differential Equation Models</h3>
<p>Differential equation models form the backbone of many scientific
simulations. These can be either abstracted, like epidemiological models
that treat populations as continuous quantities, or fine-grained like
climate models that solve complex systems of equations. These models are
based on mathematical representations of physical laws or system
behavior and often require sophisticated numerical methods for their
solution.</p>
<h3 id="discrete-event-simulations">Discrete Event Simulations</h3>
<p>Discrete event simulations come in two main varieties. Turn-based
simulations, like Conway’s Game of Life or Formula 1 strategy
simulations, update their state at regular intervals. Event-driven
simulations, like the Gillespie algorithm used in chemical models,
advance time to the next event, which might occur at irregular
intervals. Both approaches are particularly useful when studying systems
that change state at distinct moments rather than continuously.</p>
<h3 id="software-system-simulations">Software System Simulations</h3>
<p>A third important category is software system simulation,
particularly relevant in modern computing environments. These
simulations allow testing of production code systems, enabling “what if”
scenarios and counterfactual analysis. They might involve rerunning
entire codebases with simulated inputs, which is particularly valuable
when dealing with complex systems with multiple interacting
components.</p>
<h2 id="f1-and-fidelity">F1 and Fidelity</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_simulation/includes/f1-simulation-fidelity.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_simulation/includes/f1-simulation-fidelity.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>Formula 1 race simulations contain assumptions that derive from
physics but don’t directly encode the physical laws. For example, if one
car is stuck behind another, in any given lap, it might overtake. A
typical race simulation will look at the lap speed of each car and the
top speed of each car (as measured in ‘speed traps’ that are placed on
the straight). It will assume a probability of overtake for each lap
that is a function of these values. Of course, underlying that function
is the physics of how cars overtake each other, but that can be
abstracted away into a simpler function that the Race Strategy Engineer
defines from their knowledge and previous experience.</p>
<p>Many simulations have this characteristic: major parts of the
simulation are the result of encoding expert knowledge in the code. But
this can lead to challenges. I once asked a strategy engineer, who had
completed a new simulation, how it was going. He replied that things had
started out well, but over time its performance was degrading. We
discussed this for a while and over time a challenge of mis-specified
granularity emerged.</p>
<p>The engineer explained how there’d been a race where the simulation
had suggested that their main driver <em>shouldn’t</em> pit because he
would have emerged behind a car with a slower lap speed, but a high
top-speed. This would have made that car difficult to overtake. However,
the driver of that slower car was also in the team’s ‘development
program’, so everyone in the team knew that the slower car would have
moved aside to let their driver through. Unfortunately, the simulation
didn’t know this. So, the team felt the wrong stategy decision was made.
After the race, the simulation was updated to include a special case for
this situation. The new code checked whether the slower car was a
development driver, making it ‘more realistic’.</p>
<p>Over time there were a number of similar changes, each of which
should have improved the simulation, but the reality was the code was
now ‘mixing granularities’. The formula for computing the probability of
overtake as a function of speeds is one that is relatively easy to
verify. It ignores the relationships between drivers, whether a given
driver is a development driver, whether one bears a grudge or not,
whether one is fighting for their place in the team. That’s all
assimilated into the equation. The original equation is easy to
calibrate, but as soon as you move to a finer granularity and consider
more details about individual drivers, the model seems more realistic,
but it becomes difficult to specify, and therefore performance
degrades.</p>
<p>Simulations work at different fidelities, but as the Formula 1
example shows you must be very careful about mixing fidelities within
the same simulation. The appropriate fidelity of a simulation is
strongly dependent on the question being asked of it. On the context.
For example, in Formula 1 races you can also simulate the performance of
the car in the wind tunnel and using computational fluid dynamics
representations of the Navier-Stokes equations. That level of fidelity
<em>is</em> appropriate when designing the aerodynamic components of the
car, but inappropriate when building a strategy simulation.</p>
<p>The original overtaking probability calculations were clean and
verifiable. But by mixing in team politics and driver relationships,
they created a model that was harder to specify correctly.</p>
<p>The same team also uses highly detailed aerodynamics simulations with
computational fluid dynamics for car design. This different fidelity is
appropriate there - but mixing fidelities within a single simulation
often causes more problems than it solves. The key is maintaining
consistent granularity appropriate to the specific question being
asked.</p>
<h1 id="epidemiology">Epidemiology</h1>
<p>The same concept of modelling at a particular fidelity comes up in
epidemiology. Disease is transmitted by direct person to person
interactions between individuals and objects. But in theoretical
epidemiology, this is approximated by differential equations. The
resulting models look very similar to reaction rate models used in
Chemistry for well mixed beakers. Let’s have a look at a simple example
used for modelling the policy of ‘herd immunity’ for Covid19.</p>
<h2 id="modelling-herd-immunity">Modelling Herd Immunity</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_simulation/includes/herd-immunity.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_simulation/includes/herd-immunity.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>This example is taken from <a
href="https://personalpages.manchester.ac.uk/staff/thomas.house/blog/modelling-herd-immunity.html">Thomas
House’s blog post</a> on Herd Immunity. This model was shared at the
beginning of the Covid19 pandemic when the first UK lockdown hadn’t yet
occurred.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> integrate</span></code></pre></div>
<p>The next piece of code sets up the dynamics of the compartmental
model. He doesn’t give the specific details in the blog post, but my
understanding is that the four states are as follows. <code>x[0]</code>
is the susceptible population, those that haven’t had the disease yet.
The susceptible population decreases by encounters with infections
people. In Thomas’s model, both <code>x[3]</code> and <code>x[4]</code>
are infections. So, the dynamics of the reduction of the susceptible is
given by <span class="math display">\[
\frac{\text{d}{S}}{\text{d}t} = - \beta S (I_1 + I_2).
\]</span> Here, we’ve used <span class="math inline">\(I_1\)</span> and
<span class="math inline">\(I_2\)</span> to represent what appears to be
two separate infectious compartments in Thomas’s model. We’ll speculate
about why there are two in a moment.</p>
<p>The model appears to be an SEIR model, so rather than becoming
infectious directly you next move to an ‘exposed’, where you have the
disease, but you are not yet infectious. There are again <em>two</em>
exposed states, we’ll return to that in a moment. We denote the first,
<code>x[1]</code> by <span class="math inline">\(E_1\)</span>. We have
<span class="math display">\[
\frac{\text{d}{E_1}}{\text{d}t} = \beta S (I_1 + I_2) - \sigma E_1.
\]</span> Note that the first term matches the term from the Susceptible
equation. This is because it is the incoming exposed population.</p>
<p>The exposed population move to a second compartment of exposure,
<span class="math inline">\(E_2\)</span>. I believe the reason for this
is that if you use only one exposure compartment, then the statistics of
the duration of exposure are incorrect (implicitly they are
exponentially distributed in the underlying stochastic version of the
model). By using two exposure departments, Thomas is making a slight
correction to this which would impose a first order gamma distribution
on those statistics. A similar trick is being deployed for the
‘infectious group’. So, we gain an additional equation to help with
these statistics, <span class="math display">\[
\frac{\text{d}{E_2}}{\text{d}t} = \sigma E_1 - \sigma E_2.
\]</span> giving us the exposed group as the sum of the two compartments
<span class="math inline">\(E_1\)</span> and <span
class="math inline">\(E_2\)</span>. The exposed group from the second
compartment then become ‘infected’, which we represent with <span
class="math inline">\(I_1\)</span>, in the code this is
<code>x[3]</code>, <span class="math display">\[
\frac{\text{d}{I_1}}{\text{d}t} = \sigma E_2 - \gamma I_1,
\]</span> and similarly, Thomas is using a two-compartment infectious
group to fix up the duration model. So we have, <span
class="math display">\[
\frac{\text{d}{I_2}}{\text{d}t} = \gamma I_1 - \gamma I_2.
\]</span> And finally, we have those that have recovered emerging from
the second infections compartment. In this model there is no separate
model for ‘deaths’, so the recovered compartment, <span
class="math inline">\(R\)</span>, would also include those that die,
<span class="math display">\[
\frac{\text{d}R}{\text{d}t} = \gamma I_2.
\]</span> All these equations are then represented in code as
follows.</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> odefun(t,x,beta0,betat,t0,t1,sigma,gamma):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    dx <span class="op">=</span> np.zeros(<span class="dv">6</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ((t<span class="op">&gt;=</span>t0) <span class="kw">and</span> (t<span class="op">&lt;=</span>t1)):</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        beta <span class="op">=</span> betat</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        beta <span class="op">=</span> beta0</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    dx[<span class="dv">0</span>] <span class="op">=</span> <span class="op">-</span>beta<span class="op">*</span>x[<span class="dv">0</span>]<span class="op">*</span>(x[<span class="dv">3</span>] <span class="op">+</span> x[<span class="dv">4</span>])</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    dx[<span class="dv">1</span>] <span class="op">=</span> beta<span class="op">*</span>x[<span class="dv">0</span>]<span class="op">*</span>(x[<span class="dv">3</span>] <span class="op">+</span> x[<span class="dv">4</span>]) <span class="op">-</span> sigma<span class="op">*</span>x[<span class="dv">1</span>]</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    dx[<span class="dv">2</span>] <span class="op">=</span> sigma<span class="op">*</span>x[<span class="dv">1</span>] <span class="op">-</span> sigma<span class="op">*</span>x[<span class="dv">2</span>]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    dx[<span class="dv">3</span>] <span class="op">=</span> sigma<span class="op">*</span>x[<span class="dv">2</span>] <span class="op">-</span> gamma<span class="op">*</span>x[<span class="dv">3</span>]</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    dx[<span class="dv">4</span>] <span class="op">=</span> gamma<span class="op">*</span>x[<span class="dv">3</span>] <span class="op">-</span> gamma<span class="op">*</span>x[<span class="dv">4</span>]</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    dx[<span class="dv">5</span>] <span class="op">=</span> gamma<span class="op">*</span>x[<span class="dv">4</span>]</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dx</span></code></pre></div>
<p>Where the code takes in the states of the compartments (the values of
<code>x</code>) and returns the gradients of those states for the
provided parameters (<code>sigma</code>, <code>gamma</code> and
<code>beta</code>). Those parameters are set according to the known
characteristics of the disease.</p>
<p>The next block of code sets up the parameters of the SEIR model. A
particularly important parameter is the reproduction number (<span
class="math inline">\(R_0\)</span>), here Thomas has assumed a
reproduction number of 2.5, implying that each infected member of the
population transmits the infection up to 2.5 other people. The effective
<span class="math inline">\(R\)</span> decreases over time though,
because some of those people they meet will no longer be in the
susceptible group.</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters of the model</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">6.7e7</span> <span class="co"># Total population</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>i0 <span class="op">=</span> <span class="fl">1e-4</span> <span class="co"># 0.5*Proportion of the population infected on day 0</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>tlast <span class="op">=</span> <span class="fl">365.0</span> <span class="co"># Consider a year</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>latent_period <span class="op">=</span> <span class="fl">5.0</span> <span class="co"># Days between being infected and becoming infectious</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>infectious_period <span class="op">=</span> <span class="fl">7.0</span> <span class="co"># Days infectious</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>R0 <span class="op">=</span> <span class="fl">2.5</span> <span class="co"># Basic reproduction number in the absence of interventions</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>Rt <span class="op">=</span> <span class="fl">0.75</span> <span class="co"># Reproduction number in the presence of interventions</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>tend <span class="op">=</span> <span class="fl">21.0</span> <span class="co"># Number of days of interventions</span></span></code></pre></div>
<p>The parameters are correct for the ‘discrete system’, where the
infectious period is a discrete time, and the numbers are discrete
values. To translate into our continuous differential equation system’s
parameters, we need to do a couple of manipulations. Note the factor of
2 associated with <code>gamma</code> and <code>sigma</code>. This is a
doubling of the rate to account for the fact that there are two
compartments for each of these states (to fix-up the statistics of the
duration models).</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>beta0 <span class="op">=</span> R0 <span class="op">/</span> infectious_period</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>betat <span class="op">=</span> Rt <span class="op">/</span> infectious_period</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">2.0</span> <span class="op">/</span> latent_period</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>gamma <span class="op">=</span> <span class="fl">2.0</span> <span class="op">/</span> infectious_period</span></code></pre></div>
<p>Next, we solve the system using <code>scipy</code>’s initial value
problem solver. The solution method is Runge-Kutta-Fehlberg method, as
indicated by the <code>'RK45'</code> solver. This is a numerical method
for solving differential equations. The 45 is the order of the method
and the error estimator.</p>
<p>We can view the solver itself as somehow a piece of simulation code,
but here it’s being called as sub routine in the system. It returns a
solution for each time step, stored in a list <code>sol</code>.</p>
<p>This is typical of this type of non-linear differential equation
problem. Whether it’s partial differential equations, ordinary
differential equations, there’s a step where a numerical solver needs to
be called. These are often expensive to run. For climate and weather
models, this would be where we solved the Navier-Stokes equations. For
this simple model, the solution is relatively quick.</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>t0ran <span class="op">=</span> np.array([<span class="op">-</span><span class="dv">100</span>, <span class="dv">40</span>, <span class="fl">52.5</span>, <span class="dv">65</span>])</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>sol<span class="op">=</span>[]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tt <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(t0ran)):</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    sol.append(integrate.solve_ivp(<span class="kw">lambda</span> t,x: odefun(t,x,beta0,betat,t0ran[tt],t0ran[tt]<span class="op">+</span>tend,sigma,gamma),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                              (<span class="fl">0.0</span>,tlast),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                              np.array([<span class="fl">1.0</span><span class="op">-</span><span class="fl">2.0</span><span class="op">*</span>i0, <span class="fl">0.0</span>, <span class="fl">0.0</span>, i0, i0, <span class="fl">0.0</span>]),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;RK45&#39;</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                              atol<span class="op">=</span><span class="fl">1e-8</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                              rtol<span class="op">=</span><span class="fl">1e-9</span>))</span></code></pre></div>
<div class="figure">
<div id="house-model-zoom-figure" class="figure-frame">
<object class="svgplot " data="https://mlatcl.github.io/mlphysical/./slides/diagrams//simulation/house-model-zoom.svg" width="80%" style=" ">
</object>
</div>
<div id="house-model-zoom-magnify" class="magnify"
onclick="magnifyFigure(&#39;house-model-zoom&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="house-model-zoom-caption" class="caption-frame">
<p>Figure: A zoomed in version of Thomas House’s variation on the SEIR
model for evaluating the effect of early interventions.</p>
</div>
</div>
<div class="figure">
<div id="house-model-full-figure" class="figure-frame">
<object class="svgplot " data="https://mlatcl.github.io/mlphysical/./slides/diagrams//simulation/house-model-full.svg" width="80%" style=" ">
</object>
</div>
<div id="house-model-full-magnify" class="magnify"
onclick="magnifyFigure(&#39;house-model-full&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="house-model-full-caption" class="caption-frame">
<p>Figure: The full progress of the disease in Thomas House’s variation
on the SEIR model for evaluating the effect of early interventions.</p>
</div>
</div>
<p>In practice, immunity for Covid19 may only last around 6 months. As
an exercise, try to extend Thomas’s model for the case where immunity is
temporary. You’ll need to account for deaths as well in your new
model.</p>
<p>Thinking about our Formula 1 example, and the differing levels of
fidelity that might be included in a model, you can now imagine the
challenges of doing large scale theoretical epidemiology. The
compartment model is operating at a particular level of fidelity.
Imagine trying to modify this model for a specific circumstance, like
the way that the University of Cambridge chooses to do lectures. It’s
not appropriate for this level of fidelity. You need to use different
types of models for that decision making. <a
href="https://mlatcl.github.io/mlphysical/casestudies/tti-explorer.html">One
of our case studies</a> looks at a simulation that was used to advise
the government on the Test Trace Isolate program that took a different
approach <span class="citation" data-cites="Delve-tti20">(The DELVE
Initiative, 2020)</span>.</p>
<h1 id="strategies-for-simulation">Strategies for Simulation</h1>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_simulation/includes/simulation-strategies.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_simulation/includes/simulation-strategies.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>Within any simulation, we can roughly split the variables of interest
into the state variables and the parameters. In the Herd immunity
example, the state variables were the different susceptible, exposed,
infectious and recovered groups. The parameters were the reproduction
number and the expected lengths of infection and the timing of lockdown.
Often parameters are viewed as the inputs to the simulation, the things
we can control. We might want to know how to time lock down to minimize
the number of deaths. This behavior of the simulator is what we may want
to emulate with our Gaussian process model.</p>
<p>So far, we’ve introduced simulation motivated by the physical laws of
the universe. Those laws are sometimes encoded in differential
equations, in which case we can try to solve those systems (like with
Herd Immunity or Navier Stokes). An alternative approach is taken in the
Game of Life. There a turn-based simulation is used, at each turn, we
iterate through the simulation updating the state of the simulation.
This is known as a <em>discrete event simulation</em>. In race
simulation for Formula 1 a discrete event simulation is also used. There
is another form of discrete event simulation, often used in chemical
models, where the events don’t take place at regular intervals. Instead,
the timing to the next event is computed, and the simulator advances
that amount of time. For an example of this see <a
href="https://en.wikipedia.org/wiki/Gillespie_algorithm">the Gillespie
algorithm</a>.</p>
<p>There is a third type of simulation that we’d also like to introduce.
That is simulation within computer software. In particular, the need to
backtest software with ‘what if’ ideas – known as counter factual
simulation – or to trace errors that may have occurred in production.
This can involve loading up entire code bases and rerunning them with
simulated inputs. This is a third form of simulation where emulation can
also come in useful.</p>
<h2 id="backtesting-production-code">Backtesting Production Code</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_simulation/includes/production-code-simulation.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_simulation/includes/production-code-simulation.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>In large-scale production systems, simulation takes on a different
character. Rather than modeling physical phenomena, we need to simulate
entire software systems. At Amazon, for example, we worked with
simulations ranging from Prime Air drones to supply chain systems. In a
purchasing system, the idea is to store stock to balance supply and
demand. The aim is to keep product in stock for quick dispatch while
keeping prices (and therefore costs) low. This idea is at the heart of
Amazon’s focus on customer experience.</p>
<h2 id="alexa">Alexa</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_ai/includes/alexa-system.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_ai/includes/alexa-system.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<div class="centered" style="">
\tomTaylorPicture{15%}\joeWalowskiPicture{15%}\rohitPrasadPicture{15%}
</div>
<div class="figure">
<div id="alexa-architecture-overview-figure" class="figure-frame">
<iframe width="600" height="450" src="https://www.youtube.com/embed/VQVZ2hvNVfo?start=" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
</div>
<div id="alexa-architecture-overview-magnify" class="magnify"
onclick="magnifyFigure(&#39;alexa-architecture-overview&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="alexa-architecture-overview-caption" class="caption-frame">
<p>Figure: Alexa Architecture overview taken from the Alexa Skills
programme.</p>
</div>
</div>
<div class="centered" style="">
\rohitPrasadPicture{15%}
</div>
<div class="figure">
<div id="rohit-prasad-alexa-figure" class="figure-frame">
<iframe width="600" height="450" src="https://www.youtube.com/embed/wa8DU-Sui8Q?start=2520" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
</div>
<div id="rohit-prasad-alexa-magnify" class="magnify"
onclick="magnifyFigure(&#39;rohit-prasad-alexa&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="rohit-prasad-alexa-caption" class="caption-frame">
<p>Figure: Rohit Prasad talking about Alexa at the Amazon 2019 re:MARS
event.</p>
</div>
</div>
<div class="centered" style="">
\tomTaylorPicture{15%}\joeWalowskiPicture{15%}\rohitPrasadPicture{15%}
</div>
<div class="figure">
<div id="alexa-schematic-figure" class="figure-frame">
<object class="svgplot " data="https://mlatcl.github.io/mlphysical/./slides/diagrams//software/alexa-schematic.svg" width="40%" style=" ">
</object>
</div>
<div id="alexa-schematic-magnify" class="magnify"
onclick="magnifyFigure(&#39;alexa-schematic&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="alexa-schematic-caption" class="caption-frame">
<p>Figure: Simple schmeatic of an intelligent agent’s components.</p>
</div>
</div>
<h2 id="speech-to-text">Speech to Text</h2>
<div class="centered" style="">
<svg viewBox="0 0 200 200" style="width:15%">
<defs> <clipPath id="clip15">
<style>
circle {
  fill: black;
}
</style>
<circle cx="100" cy="100" r="100"/> </clipPath> </defs>
<title>
Catherine Breslin
</title>
<image preserveAspectRatio="xMinYMin slice" width="100%" xlink:href="https://mlatcl.github.io/mlphysical/./slides/diagrams//people/catherine-breslin.png" clip-path="url(#clip15)"/>
</svg>
</div>
<h2 id="cloud-service-knowledge-base">Cloud Service: Knowledge Base</h2>
<div class="centered" style="">
\davidHardcastlePicture{15%}\arpitMittalPicture{15%}\christosChristodoulopoulosPicture{15%}
</div>
<h2 id="text-to-speech">Text to Speech</h2>
<div class="centered" style="">
\andrewBreenPicture{15%}\robertoBarraChicotePicture{15%}
</div>
<h2 id="prime-air">Prime Air</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_ai/includes/prime-air-system.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_ai/includes/prime-air-system.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>One project where the components of machine learning and the physical
world come together is Amazon’s Prime Air drone delivery system.</p>
<p>Automating the process of moving physical goods through autonomous
vehicles completes the loop between the ‘bits’ and the ‘atoms’. In other
words, the information and the ‘stuff’. The idea of the drone is to
complete a component of package delivery, the notion of last mile
movement of goods, but in a fully autonomous way.</p>
<div class="centered" style="">
\gurKimchiPicture{15%}\paulViolaPicture{15%}\davidMoroPicture{15%}
</div>
<div class="figure">
<div id="amazon-drone-flight-figure" class="figure-frame">
<iframe width="600" height="450" src="https://www.youtube.com/embed/3HJtmx5f1Fc?start=" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
</div>
<div id="amazon-drone-flight-magnify" class="magnify"
onclick="magnifyFigure(&#39;amazon-drone-flight&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="amazon-drone-flight-caption" class="caption-frame">
<p>Figure: An actual ‘Santa’s sleigh’. Amazon’s prototype delivery
drone. Machine learning algorithms are used across various systems
including sensing (computer vision for detection of wires, people, dogs
etc) and piloting. The technology is necessarily a combination of old
and new ideas. The transition from vertical to horizontal flight is
vital for efficiency and uses sophisticated machine learning to
achieve.</p>
</div>
</div>
<p>As Jeff Wilke (who was CEO of Amazon Retail at the time) <a
href="https://blog.aboutamazon.com/transportation/a-drone-program-taking-flight">announced
in June 2019</a> the technology is ready, but still needs
operationalization including e.g. regulatory approval.</p>
<div class="figure">
<div id="jeff-wilke-remars-figure" class="figure-frame">
<iframe width="600" height="450" src="https://www.youtube.com/embed/wa8DU-Sui8Q?start=3767" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
</div>
<div id="jeff-wilke-remars-magnify" class="magnify"
onclick="magnifyFigure(&#39;jeff-wilke-remars&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="jeff-wilke-remars-caption" class="caption-frame">
<p>Figure: Jeff Wilke (CEO Amazon Consumer) announcing the new drone at
the Amazon 2019 re:MARS event alongside the scale of the Amazon supply
chain.</p>
</div>
</div>
<blockquote>
<p>When we announced earlier this year that we were evolving our Prime
two-day shipping offer in the U.S. to a one-day program, the response
was terrific. But we know customers are always looking for something
better, more convenient, and there may be times when one-day delivery
may not be the right choice. Can we deliver packages to customers even
faster? We think the answer is yes, and one way we’re pursuing that goal
is by pioneering autonomous drone technology.</p>
</blockquote>
<blockquote>
<p>Today at Amazon’s re:MARS Conference (Machine Learning, Automation,
Robotics and Space) in Las Vegas, we unveiled our latest Prime Air drone
design. We’ve been hard at work building fully electric drones that can
fly up to 15 miles and deliver packages under five pounds to customers
in less than 30 minutes. And, with the help of our world-class
fulfillment and delivery network, we expect to scale Prime Air both
quickly and efficiently, delivering packages via drone to customers
within months.</p>
</blockquote>
<p>The 15 miles in less than 30 minutes implies air speed velocities of
around 50 kilometers per hour.</p>
<blockquote>
<p>Our newest drone design includes advances in efficiency, stability
and, most importantly, in safety. It is also unique, and it advances the
state of the art. How so? First, it’s a hybrid design. It can do
vertical takeoffs and landings – like a helicopter. And it’s efficient
and aerodynamic—like an airplane. It also easily transitions between
these two modes—from vertical-mode to airplane mode, and back to
vertical mode.</p>
</blockquote>
<blockquote>
<p>It’s fully shrouded for safety. The shrouds are also the wings, which
makes it efficient in flight.</p>
</blockquote>
<div class="figure">
<div id="amazon-prime-air-remars-figure" class="figure-frame">
<div class="centered" style="">
<img class="" src="https://mlatcl.github.io/mlphysical/./slides/diagrams//ai/amazon-prime-air-remars-june-2019.jpg" width="80%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
<div id="amazon-prime-air-remars-magnify" class="magnify"
onclick="magnifyFigure(&#39;amazon-prime-air-remars&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="amazon-prime-air-remars-caption" class="caption-frame">
<p>Figure: Picture of the drone from Amazon Re-MARS event in 2019.</p>
</div>
</div>
<blockquote>
<p>Our drones need to be able to identify static and moving objects
coming from any direction. We employ diverse sensors and advanced
algorithms, such as multi-view stereo vision, to detect static objects
like a chimney. To detect moving objects, like a paraglider or
helicopter, we use proprietary computer-vision and machine learning
algorithms.</p>
</blockquote>
<blockquote>
<p>A customer’s yard may have clotheslines, telephone wires, or
electrical wires. Wire detection is one of the hardest challenges for
low-altitude flights. Through the use of computer-vision techniques
we’ve invented, our drones can recognize and avoid wires as they descend
into, and ascend out of, a customer’s yard.</p>
</blockquote>
<h2 id="supply-chain-optimization">Supply Chain Optimization</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_ai/includes/supply-chain-system.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_ai/includes/supply-chain-system.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<div class="centered" style="">
\llewMasonPicture{15%}\deveshMishraPicture{15%}
</div>
<p>Supply chain is the process of matching between the supply of the
product and demand for the product. This matching process is done
through the deployment of resources: places to store the products, ways
and means of transporting the product and even the ability to transform
products from one form to another (e.g. transforming paper into books
through printing).</p>
<div class="figure">
<div id="scot-promo-video-figure" class="figure-frame">
<iframe width="600" height="450" src="https://www.youtube.com/embed/ncwsr1Of6Cw?start=" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
</div>
<div id="scot-promo-video-magnify" class="magnify"
onclick="magnifyFigure(&#39;scot-promo-video&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="scot-promo-video-caption" class="caption-frame">
<p>Figure: Promotional video for the Amazon supply chain optimization
team.</p>
</div>
</div>
<p>Arugably the Amazon supply chain is (or was) the largest automated
decision-making system in the world in terms of the amount of money
spent and the quantity of product moved through automated decision
making.</p>
<h2 id="supply-chain-optimization-1">Supply Chain Optimization</h2>
<div class="centered" style="">
\llewMasonPicture{15%}\deveshMishraPicture{15%}
</div>
<p>At the heart of an automated supply chain is the buying system, which
determines the optimal stock level for products and makes purchases
based on the difference between that stock level and the current stock
level.</p>
<div class="figure">
<div id="buying-schematic-figure" class="figure-frame">
<object class="svgplot " data="https://mlatcl.github.io/mlphysical/./slides/diagrams//software/buying-schematic.svg" width="40%" style=" ">
</object>
</div>
<div id="buying-schematic-magnify" class="magnify"
onclick="magnifyFigure(&#39;buying-schematic&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="buying-schematic-caption" class="caption-frame">
<p>Figure: A schematic of a typical buying system for supply chain.</p>
</div>
</div>
<p>To make these decisions predictive models (often machine learning or
statistical models) have to be moved. For example, the demand for a
particular product needs to be forecast.</p>
<h2 id="forecasting">Forecasting</h2>
<div class="centered" style="">
\jennyFreshwaterPicture{15%}\pingXuPicture{15%}\deanFosterPicture{15%}
</div>
<div class="figure">
<div id="jenny-freshwater-remars-figure" class="figure-frame">
<iframe width="600" height="450" src="https://www.youtube.com/embed/wa8DU-Sui8Q?start=1358" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
</div>
<div id="jenny-freshwater-remars-magnify" class="magnify"
onclick="magnifyFigure(&#39;jenny-freshwater-remars&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="jenny-freshwater-remars-caption" class="caption-frame">
<p>Figure: Jenny Freshwater speaking at the Amazon re:MARS event in June
2019.</p>
</div>
</div>
<p>The process of forecasting is described by Jenny Freshwater (at the
time Director for Forecasting within Amazon’s Supply Chain Optimization
team in the video in Figure <span
class="math inline">\(\ref{jenny-freshwater-remars}\)</span>.</p>
<p>For each product in the Amazon catalogue, the demand is forecast
across the a given future period.</p>
<h2 id="inventory-and-buying">Inventory and Buying</h2>
<div class="centered" style="">
\deepakBhatiaPicture{15%}\piyushSaraogiPicture{15%}\ramanIyerPicture{15%}\salalHumairPicture{15%}\narayanVenkatasubramanyanPicture{15%}
</div>
<p>Forecast information is combined with predictions around lead times
from suppliers, understanding of the network’s capacity (in terms of how
much space is available in which fulfillment centers), the cost of
storing and transporting products and the “value” for the consumer in
finding the product is in stock. These models are typically operational
research models (such as the “newsvendor problem” combined with machine
learning and/or statistical forecasts.</p>
<h2 id="buying-system">Buying System</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_ai/includes/buying-system.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_ai/includes/buying-system.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>An example of a complex decision-making system might be an automated
buying system. In such a system, the idea is to match demand for
products to supply of products.</p>
<p>The matching of demand and supply is a repetitive theme for decision
making systems. Not only does it occur in automated buying, but also in
the allocation of drivers to riders in a ride sharing system. Or in the
allocation of compute resource to users in a cloud system.</p>
<p>The components of any of these systems include predictions of the
demand for the product, the drivers, or the compute. Predictions of the
supply. Decisions are then made for how much material to keep in stock,
or how many drivers to have on the road, or how much computer capacity
to have in your data centers. These decisions have cost implications.
The optimal amount of product will depend on the cost of making it
available. For a buying system this is the storage costs.</p>
<p>Decisions are made based on the supply and demand to make new orders,
to encourage more drivers to come into the system or to build new data
centers or rent more computational power.</p>
<div class="figure">
<div id="buying-system-components-figure" class="figure-frame">
<object class="svgplot " data="https://mlatcl.github.io/mlphysical/./slides/diagrams//software/buying-schematic.svg" width="40%" style=" ">
</object>
</div>
<div id="buying-system-components-magnify" class="magnify"
onclick="magnifyFigure(&#39;buying-system-components&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="buying-system-components-caption" class="caption-frame">
<p>Figure: The components of a putative automated buying system</p>
</div>
</div>
<h2 id="monolithic-system">Monolithic System</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_ai/includes/aws-soa.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_ai/includes/aws-soa.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>The classical approach to building these systems was a ‘monolithic
system’. Built in a similar way to the successful applications software
such as Excel or Word, or large operating systems, a single code base
was constructed. The complexity of such code bases run to many
lines.</p>
<p>In practice, shared dynamically linked libraries may be used for
aspects such as user interface, or networking, but the software often
has many millions of lines of code. For example, the Microsoft Office
suite is said to contain over 30 million lines of code.</p>
<div class="centered" style="">
\charlieBellPicture{15%}\peterVosshallPicture{15%}
</div>
<div class="figure">
<div id="ml-system-monolith-figure" class="figure-frame">
<object class="svgplot " data="https://mlatcl.github.io/mlphysical/./slides/diagrams//ai/ml-system-monolith-purchasing.svg" width="60%" style=" ">
</object>
</div>
<div id="ml-system-monolith-magnify" class="magnify"
onclick="magnifyFigure(&#39;ml-system-monolith&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="ml-system-monolith-caption" class="caption-frame">
<p>Figure: A potential path of models in a machine learning system.</p>
</div>
</div>
<p>Such software is not only difficult to develop, but also to scale
when computation demands increase. Amazon’s original website software
(called Obidos) was a <a
href="https://en.wikipedia.org/wiki/Obidos_(software)">monolithic
design</a> but by the early noughties it was becoming difficult to
sustain and maintain. The software was phased out in 2006 to be replaced
by a modularized software known as a ‘service-oriented
architecture’.</p>
<h2 id="service-oriented-architecture">Service Oriented
Architecture</h2>
<div class="centered" style="">
\charlieBellPicture{15%}\peterVosshallPicture{15%}
</div>
<p>In Service Oriented Architecture, or “Software as a Service” the idea
is that code bases are modularized and communicate with one another
using network requests. A standard approach is to use a <a
href="https://en.wikipedia.org/wiki/Representational_state_transfer">REST
API</a>. So, rather than a single monolithic code base, the code is
developed with individual services that handle the different
requests.</p>
<div class="figure">
<div id="ml-system-downstream-purchasing-figure" class="figure-frame">
<object class="svgplot " data="https://mlatcl.github.io/mlphysical/./slides/diagrams//ai/ml-system-downstream-purchasing000.svg" width="60%" style=" ">
</object>
</div>
<div id="ml-system-downstream-purchasing-magnify" class="magnify"
onclick="magnifyFigure(&#39;ml-system-downstream-purchasing&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="ml-system-downstream-purchasing-caption" class="caption-frame">
<p>Figure: A potential path of models in a machine learning system.</p>
</div>
</div>
<p>Modern software development uses an approach known as
<em>service-oriented architecture</em> to build highly complex systems.
Such systems have similar emergent properties to Conway’s “Game of
Life”. Understanding these emergent properties is vitally important when
diagnosing problems in the system.</p>
<h2 id="intellectual-debt">Intellectual Debt</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_ai/includes/intellectual-debt-blog-post.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_ai/includes/intellectual-debt-blog-post.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<div class="figure">
<div id="intellectual-debt-figure" class="figure-frame">
<div class="centered" style="">
<img class="" src="https://mlatcl.github.io/mlphysical/./slides/diagrams//ai/2020-02-12-intellectual-debt.png" width="70%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
<div id="intellectual-debt-magnify" class="magnify"
onclick="magnifyFigure(&#39;intellectual-debt&#39;)">
<img class="img-button" src="{{ '/assets/images/Magnify_Large.svg' | relative_url }}" style="width:1.5ex">
</div>
<div id="intellectual-debt-caption" class="caption-frame">
<p>Figure: Jonathan Zittrain’s term to describe the challenges of
explanation that come with AI is Intellectual Debt.</p>
</div>
</div>
<p>In the context of machine learning and complex systems, Jonathan
Zittrain has coined the term <a
href="https://medium.com/berkman-klein-center/from-technical-debt-to-intellectual-debt-in-ai-e05ac56a502c">“Intellectual
Debt”</a> to describe the challenge of understanding what you’ve
created. In <a
href="https://mlatcl.github.io/projects/data-oriented-architectures-for-ai-based-systems.html">the
ML@CL group we’ve been foucssing on developing the notion of a
<em>data-oriented architecture</em></a> to deal with intellectual debt
<span class="citation" data-cites="Cabrera-realworld23">(Cabrera et al.,
2023)</span>.</p>
<p>Zittrain points out the challenge around the lack of interpretability
of individual ML models as the origin of intellectual debt. In machine
learning I refer to work in this area as fairness, interpretability and
transparency or FIT models. To an extent I agree with Zittrain, but if
we understand the context and purpose of the decision making, I believe
this is readily put right by the correct monitoring and retraining
regime around the model. A concept I refer to as “progression testing”.
Indeed, the best teams do this at the moment, and their failure to do it
feels more of a matter of technical debt rather than intellectual,
because arguably it is a maintenance task rather than an explanation
task. After all, we have good statistical tools for interpreting
individual models and decisions when we have the context. We can
linearise around the operating point, we can perform counterfactual
tests on the model. We can build empirical validation sets that explore
fairness or accuracy of the model.</p>
<p>See <span class="citation" data-cites="Lawrence-atomic24">Lawrence
(2024)</span> intellectual debt p. 84, 85, 349, 365.</p>
<p>This is the landscape we now find ourselves in with regard to
software development. In practice, each of these services is often
‘owned’ and maintained by an individual team. The team is judged by the
quality of their service provision. They work to detailed specifications
on what their service should output, what its availability should be and
other objectives like speed of response. This allows for conditional
independence between teams and for faster development.</p>
<p>Clearly Conway’s Game of Life exhibits an enormous amount of
intellectual debt, indeed that was the idea. Build something simple that
exhibits great complexity. That’s what makes it so popular. But in
deployed system software, intellectual debt is a major headache and
emulation presents one way of dealing with it.</p>
<p>Unfortunately, it also makes sophisticated software systems a
breeding ground for intellectual debt. Particularly when they contain
components which are themselves ML components. Dealing with this
challenge is a major objective of my Senior AI Fellowship at the Alan
Turing Institute. You can see me talking about the problems <a
href="http://inverseprobability.com/talks/notes/deploying-machine-learning-systems-intellectual-debt-and-auto-ai.html">at
this recent seminar given virtually in Manchester</a>.</p>
<h2 id="examples-in-python">Examples in Python</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span
class="editsection"
style=""><a href="https://github.com/lawrennd/snippets/edit/main/_simulation/includes/python-simulation-resources.md" target="_blank" onclick="ga('send', 'event', 'Edit Page', 'Edit', 'https://github.com/lawrennd/snippets/edit/main/_simulation/includes/python-simulation-resources.md', 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>There are many Python resources available for different types of
simulation:</p>
<ul>
<li>General Purpose:
<ul>
<li><code>simpy</code> provides <a
href="https://simpy.readthedocs.io/en/latest/examples/">examples</a> of
machine shops, gas stations, car washes</li>
<li>The news vendor problem for <a
href="https://github.com/fabryandrea/newsvendor">NFL jersey
orders</a></li>
<li><a
href="https://github.com/amzn/supply-chain-simulation-environment">Amazon’s
supply chain simulation</a></li>
</ul></li>
<li>Control Systems:
<ul>
<li><a href="https://www.moorepants.info/blog/npendulum.html">N-link
pendulum</a> using symbolic Python</li>
<li><a
href="https://github.com/openai/gym/blob/master/gym/envs/classic_control/mountain_car.py">Mountain
Car</a> in OpenAI Gym</li>
</ul></li>
<li>Scientific Computing:
<ul>
<li><a
href="https://mark-kramer.github.io/Case-Studies-Python/HH.html">Hodgkin-Huxley
neuron models</a></li>
<li><a href="https://github.com/rothnic/formulapy">Formula One race
simulation</a></li>
<li><a href="https://github.com/barbagroup/CFDPython">Computational
fluid dynamics</a></li>
<li><a
href="https://solidspy.readthedocs.io/en/latest/readme.html">Finite
element analysis</a></li>
</ul></li>
</ul>
<p>There are a number of different simulations available in python, and
tools specifically design for simulation. For example <code>simpy</code>
has a <a href="https://simpy.readthedocs.io/en/latest/examples/">list of
example simulations</a> around machine shops, gas stations, car
washes.</p>
<p>Operations research ideas like the newsvendor problem, can also be
solved, Andrea Fabry provides an example of the newsvendor problem in
python for order of <a
href="https://github.com/fabryandrea/newsvendor">NFL replica jerseys
here</a>.</p>
<p>The news vendor problem is also a component in the Amazon supply
chain. The Amazon supply chain makes predictions about supply and
demand, combines them with a cost basis and computes optimal stock.
Inventory orders are based on the difference between this optimal stock
and current stock. The <a
href="https://github.com/amzn/supply-chain-simulation-environment">MiniSCOT
simulation</a> provides code that illustrates this.</p>
<p>Control problems are also systems that aim to achieve objectives
given a set of parameters. A classic control problem is the inverted
pendulum. This <a
href="https://www.moorepants.info/blog/npendulum.html">python code</a>
generalises the standard inverted pendulum using one with <span
class="math inline">\(n\)</span>-links using symbolic python code.</p>
<p>In reinforcement learning similar control problems are studied, a
classic reinforcement learning problem is known as the <a
href="https://github.com/openai/gym/blob/master/gym/envs/classic_control/mountain_car.py">Mountain
Car</a>. You can work with this problem using an environment known as <a
href="https://github.com/openai/gym">OpenAI gym</a> that includes many
different reinforcement learning scenarios.</p>
<p>In neuroscience Hodgkin and Huxley studied the giant axon in squid to
work out a set of differential equations that are still used today to
model spiking neurons. Mark Kramer explains how to <a
href="https://mark-kramer.github.io/Case-Studies-Python/HH.html">simulate
them in python here</a>.</p>
<p>All Formula One race teams simulate the race to determine their
strategy (tyres, pit stops etc). While those simulations are
proprietary, there is sufficient interest in the wider community that
race simulations have been developed in python. Here is <a
href="https://github.com/rothnic/formulapy">one that Nick Roth has made
available</a>.</p>
<p>Formula one teams also make use of simulation to design car parts.
There are at least two components to this, simulations that allow the
modelling of fluid flow across the car, and simulations that analyze the
capabilities of materials under stress. You can find computational <a
href="https://github.com/barbagroup/CFDPython">fluild dynamics
simulations in python here</a> and <a
href="https://solidspy.readthedocs.io/en/latest/readme.html">finite
element analysis methods for computing stress in materials here</a>.</p>
<p>Alongside continuous system simulation through partial differential
equations, another form of simulation that arises is known as
<em>discrete event simulation</em>. This comes up in c<a
href="https://github.com/mkalewski/sim2net">omputer networks</a> and
also in chemical systems where the approach to simulating is kown as the
<a
href="https://github.com/karinsasaki/gillespie-algorithm-python/">Gillespie
algorithm</a>.</p>
<h2 id="conclusions">Conclusions</h2>
<p>We summarized the different types of simulation into roughly three
groups. Firstly, those based on physical laws in the form of
differential equations. Examples include certain compartmental
epidemiological models, climate models and weather models. Secondly,
discrete event simulations. These simulations often run to a ‘clock’,
where updates to the state are taken in turns. The Game of Life is an
example of this type of simulation, and Formula 1 models of race
strategy also use this approach. There is another type of discrete event
simulation that doesn’t use a turn-based approach but waits for the next
event. The <a
href="https://en.wikipedia.org/wiki/Gillespie_algorithm">Gillespie
algorithm</a> is an example of such an approach but we didn’t cover it
here. Finally, we realized that general computer code bases are also
simulations. If a company has a large body of code, and particularly if
it’s hosted within a streaming environment (such as Apache Kafka), it’s
possible to back test the code with different inputs. Such backtests can
be viewed as simulations, and in the case of large bodies of code (such
as the code that manages Amazon’s automated buying systems) the back
tests can be slow and could also benefit from emulation.</p>
<p>We’ve introduced emulation as a way of dealing with different
fidelities of simulations and removing the computational demands that
come with them. We’ve highlighted how emulation can be deployed and
introduced the <code>GPy</code> software for Gaussian process
modelling.</p>
<h2 id="thanks">Thanks!</h2>
<p>For more information on these subjects and more you might want to
check the following resources.</p>
<ul>
<li>book: <a
href="https://www.penguin.co.uk/books/455130/the-atomic-human-by-lawrence-neil-d/9780241625248">The
Atomic Human</a></li>
<li>twitter: <a href="https://twitter.com/lawrennd">@lawrennd</a></li>
<li>podcast: <a href="http://thetalkingmachines.com">The Talking
Machines</a></li>
<li>newspaper: <a
href="http://www.theguardian.com/profile/neil-lawrence">Guardian Profile
Page</a></li>
<li>blog: <a
href="http://inverseprobability.com/blog.html">http://inverseprobability.com</a></li>
</ul>
<h1 class="unnumbered" id="references">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent"
role="list">
<div id="ref-Cabrera-realworld23" class="csl-entry" role="listitem">
Cabrera, C., Paleyes, A., Thodoroff, P., Lawrence, N.D., 2023. <a
href="https://arxiv.org/abs/2302.04810">Real-world machine learning
systems: A survey from a data-oriented architecture perspective</a>.
</div>
<div id="ref-Cheng-evidence20" class="csl-entry" role="listitem">
Cheng, B., Mazzola, G., Pickard, C.J., Ceriotti, M., 2020. Evidence for
supercritical behaviour of high-pressure liquid hydrogen. Nature 585,
217–220. <a
href="https://doi.org/10.1038/s41586-020-2677-y">https://doi.org/10.1038/s41586-020-2677-y</a>
</div>
<div id="ref-Lawrence-atomic24" class="csl-entry" role="listitem">
Lawrence, N.D., 2024. <a
href="https://www.penguin.co.uk/books/455130/the-atomic-human-by-lawrence-neil-d/9780241625248">The
atomic human: Understanding ourselves in the age of AI</a>. Allen Lane.
</div>
<div id="ref-Delve-tti20" class="csl-entry" role="listitem">
The DELVE Initiative, 2020. <a
href="https://rs-delve.github.io/reports/2020/05/27/test-trace-isolate.html">Test,
trace, isolate</a>. The Royal Society.
</div>
</div>

